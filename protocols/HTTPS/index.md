# HTTPS

> HTTPS与HTTP相面,下面提供一个传输级的密码安全层。可以使用SSL，也可以使用后继者传输层安全(TLS)
> SSL——Secure Sockets Layer,TLS——Transport Layer Secure

#### 加密技术相关

> 对称密钥加密技术(symmetric-key): 编码密钥e 和 解码密钥d 相同 (著名加密算法： DES,Trible-DES,RC2,RC4)
> 缺点：
> * 由于发送者和接受者共享同一个密钥,意味着在对话之前，一定有一个共享的保密钥匙
> * 还有假设访问者有ABC,那么就得有3个密钥,万一用户数量过多,就会带来很多麻烦

> 公开密钥加密(非对称加密): 公钥用来对客户端报文加密,私钥对加密的报文解密 (例如 RSA加密技术)
> 编码密钥即公钥是公开的 所以称为公开密钥加密
> 优点： 每个客户都可以用同一个密钥
> 缺点： 算法的计算可能很慢，也容易被中间人攻击(**因为完全有可能用户不知道自己访问的网站的身份是否正确**)

#### 数字证书

数字签名(我的理解 **数字签名就是加密的信息**): 用加密系统对报文进行签名，以说明是谁编写的报文，同时证明报文未被篡改过。(通常是用非对称加密方法产生的)

> 注意：解码函数只是一个函数。因此，可以将其用于任意的输入。同样，在RSA加密中，任何顺序调用D(解密)或E(加密）函数,最后结果都一样

> 数字证书的主要内容
> * 对象名称(人，服务器，组织等)
> * 过期时间
> * 证书发布者
> * 来自证书发布者的数字签名
> * 公开密钥

详情可以看\<<HTTP权威指南>> p337

#### HTTPS 概述

假如浏览器对某个网络资源执行事物时，它会去检查URL的方案
* HTTP 客户端打开一条到80(默认HTTP端口)的连接，并发送HTTP请求
* HTTPS 客户端打开一条到443(默认端口)的连接,然后与服务器“握手”,以二进制格式与服务器交换一些SSL安全参数,附上加密的HTTP命令

在发送已加密的HTTP请求之前，客户端和服务器要进行一次SSL握手。在这次握手中，它们要完成以下工作：
* 交换协议版本号
* 选择一个两端都了解的密码
* 对两端对身份进行认证
* 生成临时的会话密钥，以便加密通信

具体握手过程(客户端和服务建立443端口的TCP连接后)
* 客户端发送可供选择的密码并请求证书
* 服务器发送**选中的密码和证书**
* 客户端发送保密信息；客户端和服务器生成密钥(作用: 核对服务器身份,生成对称加密密钥)
* 客户端和服务器互相告知，开始加密过程

#### 通过代理以隧道形式传输安全流量
客户端通常会用Web代理服务器代表它们来访问Web服务器。比如，很多公司会在公司网络和公共英特网的安全边界上放置一个代理。
但只要客户端在SSL握手环节，经由公钥加密，代理就不能读取首部了。就无法知道应该将请求转向给那个服务器。

为了解决这个问题，常用的技术就是HTTPS SSL 隧道协议。使用HTTPS隧道协议之前，客户端首先要告知代理，它想要连接的安全主机和端口。这是在加密前，以明文告知的，所以代理能理解。

详细过程:
> HTTP通过新的名为CONNECT的扩展方法来发送明文形势的连接端点信息。CONNECT方法会告诉代理，打开一条到所期望主机和端口号的连接。这项工作完成后，**直接在客户端和服务器之间以隧道形势传输数据。**